<!DOCTYPE html>
<!--
   COLLABORATORS:
   keren gu
   katie bartel
   
  -->
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>StoryTime</title>
    <!-- Load style sheets -->
    <link rel="stylesheet" type="text/css" href="style/main.css" />
    <!-- <link rel="stylesheet" type="text/css" href="style/kid-library.css" /> -->
    <link href="Booklet-master/booklet/jquery.booklet.latest.css" type="text/css" rel="stylesheet" media="screen, projection, tv" />

    <link href='http://fonts.googleapis.com/css?family=Englebert' rel='stylesheet' type='text/css'>

    <link type="text/css" href="style/parent-library.css" rel="stylesheet" />
    <script type="text/javascript" src="external_js/jquery-1.9.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script> window.jQuery || document.write('<script src="Booklet-master/booklet/jquery-2.1.0.min.js"><\/script>') </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <script> window.jQuery.ui || document.write('<script src="Booklet-master/booklet/jquery-ui-1.10.4.min.js"><\/script>') </script>
    <script src="Booklet-master/booklet/jquery.easing.1.3.js"></script>
    <script src="Booklet-master/booklet/jquery.booklet.latest.js"></script>
    <script type='text/javascript' src='blur.js'></script>
    

    <script type = "text/javascript">
    var hIncr;
    var vIncr;
    var suppressBookHide = true;
    var mode;
    function createDescriptionView(){
      boardSize = 2.5;
      var incr = 600/boardSize;
      var hIncr = incr;
      var vIncr = incr;
    }


    function createGridView(perRow){
      mode = "grid"
      tableButton = document.getElementById("table-button");
      gridButton = document.getElementById("grid-button");
      tableButton.style.backgroundColor = "#d4f4f1";
      tableButton.style.color = "#666";
      gridButton.disabled = true;
      tableButton.disabled = false;
      console.log();
      hIncr = $('#column-right').height()/perRow;
      //vIncr = 600/boardSize*1.2;
      vIncr = hIncr * 5 /3;
      var book = 1;
      for(var i = 0; i < 12/perRow; i ++){
          for(var j = 0; j < perRow; j++){
              add(book.toString(),i,j);
              book++;
          }
      }
    }

    function add(name, row, col){
      var body = document.getElementById('column-right');
      var img = setImage(name, hIncr, vIncr);
      img.style.position = "absolute";
      img.style.left = 70+col*vIncr + "px";
      img.style.top = 10+row*hIncr*1.7 + "px";
      body.appendChild(img);
    }

    function setImage(name, hIncr, vIncr){
     // console.log(name);
      var img = document.createElement("img");
      img.src = '../graphics/'+name+".jpeg";
    
      img.style.width = hIncr+"px";
      img.style.height = "auto";
      img.style.zIndex = "1";
      img.setAttribute("id",name)
      img.setAttribute("draggable",false);
    
      //console.log(hIncr, vIncr);
      //console.log(img);
      return img;
    }

    function createRowView(){
      mode = "row"
      tableButton = document.getElementById("table-button");
      gridButton = document.getElementById("grid-button");
      gridButton.disabled = false;
      tableButton.disabled = true;
      gridButton.style.backgroundColor = "#d4f4f1";
      gridButton.style.color = "#666";      
      boardSize = 4;
      var incr = $('#column-right').height()/boardSize;
      var hIncr = incr;
      var vIncr = incr;
     // console.log(vIncr,hIncr);
      var body = document.getElementById('column-right');

      for (var j = 0; j <=11; j++){
        var div = document.createElement("div");
        div.style.position = "relative";
        div.style.left = 2+"%";
        div.style.top = .2*hIncr * j + "px";
        div.className = "book-div"
        //div.style.textAlign = "left"
        div.style.width = 93 + "%";
        var img = setImage((j+1).toString(), hIncr,vIncr);
        img.height = hIncr + "px";
        img.style.position = "relative";
        //img.style.left = 5 + "px";
        //img.style.display = "inline";
        //var p = document.createElement("p");
        var text = document.createTextNode("The Giving Tree is a children's picture book written and illustrated by Shel Silverstein. First published in 1964 by Harper & Row, it has become one of Silverstein's best known titles and has been translated into numerous languages. Some argue that the popularity of the book is due to the romantic relationship between the child and the tree. However, others are of the opinion that such a relationship should not be portrayed to children at such a young age, for fear that they will join the gays.  Research has shown that this fear is unfounded, as tree lovers have an equal occurence of homosexuality as the general population."); 

        var tbl = document.createElement("table");
        var tblBody = document.createElement("tbody");

        tbl.setAttribute('border', '0');
        var row = document.createElement('tr');
        var cell1 = document.createElement("td");
        cell1.appendChild(img);
        cell1.style.width = "190px";
        row.appendChild(cell1);
        cell2 = document.createElement("td");
        cell2.appendChild(text);
        cell2.style.width = "800px";
        cell2.style.textAlign = "left"
        //cell2.style.left = 10+"px";
        row.appendChild(cell2);
        tblBody.appendChild(row);
        tbl.appendChild(tblBody);
        div.appendChild(tbl);
        //p.appendChild(text);
        //p.style.whiteSpace = ;
        //div.appendChild(img);
        //div.appendChild(p);
        body.appendChild(div);
      }
    }

    function openBook(book){
          $("body").append("<div class='blur-overlay'></div>");

          //var id = book[0].id;
          $(".book-popup").show();
          $("#mybook").show();

          $('#cancel-popup').click(function(){
            $('.blur-overlay').remove();
            $(".book-popup").hide();
            $("#mybook").hide();
          });

          ("#play-button").click(function(){
            var divElement = $('.b-p1').find('.p-title')[0];
            var title = divElement.title;
            console.log(title);
            var audio = document.getElementById(title);
            audio.play();
          });

          $(".book-popup").append(playButton);
        }

    $(document).ready(function() {
      // Format the booklet
      $("#mybook").booklet({ pageNumbers: false });
      $(".book-popup").hide();
      $("#mybook").hide();

    /*  $('#library-div').blurjs({
        draggable: true,
        overlay: 'rgba(255,255,255,0.1)',
        radius:10
      }); */

      // Hide the possible book at first
      $("#mybook").hide()
      var cue = document.getElementById("recording");
      $("h3").mouseup(function(){
        cue.innerHTML = "<img src = '../graphics/not-record.png'>";
      });
      $("h3").mousedown(function(){
        cue.innerHTML = "<img src = '../graphics/record.png'>";
        var pointer = document.getElementById("pointer");
        pointer.innerHTML = "";
        $("#pointer").finish();
      });

      $("#library-div").on("click", function(e) {
        console.log("clicked, trying to exit");
        console.log(suppressBookHide);
        console.log("visible? " + $('#mybook').is(':visible'));
        if($('#mybook').is(':visible') && !suppressBookHide) {
          console.log("book is hidden");
          $("#mybook").hide();
        }
        suppressBookHide = false;

      });

      //createGridView(4);
      createRowView();
     
      // Clicking on a book should unhide the book view
      $('.imgContain').on("click","a,img", function (e) {
        var id = e.target.getAttribute('id');
        e.preventDefault();
        console.log("clicked img");
        openBook("book");
        //alert('You Clicked On Book '+id);
        //window.location.href = 'recording.html'
      });

      $('#column-left').on("click","a,img", function (e) {

        var id = e.target.getAttribute('id');
        var label = e.target;
       
        e.preventDefault();
      });

      // Prevent typical dragging functionality
      $(document).on('dragstart', function(event) { event.preventDefault(); });

      $('#column-left').on("click","a,img", function (e) {

        var id = e.target.getAttribute('id');
        var label = e.target;
        var oldLabel = document.getElementsByClassName("active")[0]
        oldLabel.style.color = "grey";
        oldLabel.className = "";
        label.style.color = "#eee";
        label.className = "active";
        e.preventDefault();
        //window.location.href = 'Book.html'
      });

      $("#grid-button").click(function(evt){
        console.log("viewing Grid!")
        $(".imgContain").empty();
        createGridView(4);
        console.log("viewing grid!");
      });

      $("#table-button").click(function(evt){
        console.log("viewing Table!")
        $(".imgContain").empty();
        createRowView();
        console.log("viewing table!");
      });

      $('#logo-navigation-button').click(function(){
          console.log("go to home")
          window.location.href = 'home.html';
        });

      $('#new-list').click(function(){
      
    });

      $('#table-button').hover(function(){
        if(mode != "row"){
          // mouseenter
          $(this).animate({'background-color':'#2CCCBC', "color": "#FFF"},300);
        }
      }, function(){
        if(mode != "row"){
          // mouseleave
          $(this).animate({'background-color':'#d4f4f1', "color": "#666"},300);
        }
      });

      $('#grid-button').hover(function(){
        if(mode != "grid"){
          // mouseenter
          $(this).animate({'background-color':'#2CCCBC', "color": "#FFF"},300);
        }
      }, function(){
        if(mode != "grid"){
          // mouseleave
          $(this).animate({'background-color':'#d4f4f1', "color": "#666"},300);
        }
      });       

    });
    </script>
  </head>
  
  <body>
    <div class="wrapper">
      <div id="big-frame">
        <div class="top-navigation">
          <div id="grid-button" class = "bar-button" type="button"/> 
          Grid 
        </div>
        <div id="table-button" class = "bar-button" type="button"/> 
        Table 
      </div>
      <div id="logo-navigation-button" type="button">
        <span class="story">Story</span><span class="time">Time</span>
      </div>

    </div>        

    <div id="library-div" class="main-frame">
      <div id="column-left">
        <ul>
          <span id = "search"><label> Search </label> <input type = "text" name = "search"></span>
          <li class = "section" id = "library"><a href = "#">My Library</a></li>
          <div id = "library-contents">
            <ul>
              <li><a href = "#" id = "dogs">Dogs</a></li>
              <li><a href = "#" id = "nature">Nature</a></li>
              <li class = "active" id = "robots"><a href = "#">Robots</a></li>
              <li><a href = "#" id = "dragons">Dragons</a></li>
            </ul> 
          </div>
          <li class = "section"><a href = "#">Discover More Books</a></li>
          <li id = "new-list"><a href = "#">+ New Reading List</a></li>
        </ul>
      </div>
      <div id="column-center">
        <p>  </p>
      </div>
      <div id="column-right" class = "imgContain">
      </div>
    </div>

  </div>
  </div>

    <div class = "book-popup">
    <div id='mybook' style="height:600px; width:auto;">
      <!-- FIRST PAGE -->
      <div  class="p-title" title='first-page'> 
        <center> 
          <h3>The Giving Tree</h3>
          <img src = '../graphics/book/GivingTree.jpg'> 
          <audio controls id="first-page" class="audio-controls">
            <source src="../audios/first-page.mp3" type="audio/mp3">
            Your browser does not support the audio element.
          </audio>
        </center>
      </div>
      <!-- SECOND PAGE -->
      <div class="p-title" title='second-page'>
          <h3>Once there was a tree</h3>
          <div id='pointer' style='position:absolute;'><img src = '../graphics/pointer.png'></div>
          <!-- <img src = '../graphics/book/Maple-tree.png'> -->
      </div>
      <!-- THIRD PAGE -->
      <div  class="p-title" title='third-page'>
        <h3>That loved a little boy</h3>
        <img src = '../graphics/book/boy.png'>
        <audio controls id="third-page" class="audio-controls">
          <source src="../audios/third-page.mp3" type="audio/mp3">
          Your browser does not support the audio element.
        </audio>  
      </div>
      <!-- FOURTH PAGE -->
      <div  class="p-title" title='fourth-page'>
        <h3>And every day the boy would come</h3>
        <!-- <embed class="audio" id="fourth-page" src="../audio/fourth-page.mp3"> -->
      </div>
      <!-- FIFTH PAGE -->
      <div  class="p-title" title='fifth-page'>
        <h3>All over the tree!</h3>
        <audio controls id="first-page" class="audio-controls">
          <source src="../audios/first-page.mp3" type="audio/mp3">
          Your browser does not support the audio element.
        </audio>
      </div>
      <!-- SIXTH PAGE -->
      <div  class="p-title" title='sixth-page'>
        <h3>The End.</h3>
        <h2><a href = 'kid-library.html'>here</a></h2>
      </div>
    <!-- END OF BOOK -->
    </div> 

    <img id="cancel-popup" class="cancel-button"/>

    <img id="play-button" src="../graphics/play2.png">
  </div>

</body>
</html>
